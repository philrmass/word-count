function parseWords(text) {
  //??? use regex to remove punctuation
  let words = text.toLowerCase().split(" ");
  return words;
}

function countWords(counter, word) {
  counter[word] = (counter[word] || 0) + 1;
  return counter;
};


function addWordCount(parent, word, count) {
    let wordNode = document.createElement("li");
    let wordText = document.createTextNode(word);
    let countNode = document.createElement("span");
    let countText = document.createTextNode(" " + count);

    wordNode.appendChild(wordText);
    countNode.appendChild(countText);
    wordNode.appendChild(countNode);
    parent.appendChild(wordNode);
}

function displayWords(wordCounter) {
  let words = Object.getOwnPropertyNames(wordCounter);

  //??? remove after testing: inverse sort
  words.sort(function (a, b) {
    return wordCounter[a] - wordCounter[b];
  })
  /*
  words.sort(function (a, b) {
    return wordCounter[b] - wordCounter[a];
  })
  */

  let wordCounts = document.getElementById("word-counts");
  wordCounts.innerHTML = "";
  words.forEach(function(word) {
    addWordCount(wordCounts, word, wordCounter[word]);
  })
}

document.addEventListener("DOMContentLoaded", function() {
  let declaration = document.getElementById("declaration");
  let gettysburg = document.getElementById("gettysburg");
  let catHat = document.getElementById("cat-hat");
  let wordsText = document.getElementById("words-text");
  let count = document.getElementById("count");
  let clear = document.getElementById("clear");
  let wordCounts = document.getElementById("word-counts");

  declaration.onclick = function() {
    wordsText.value = declarationText;
  };
  gettysburg.onclick = function() {
    wordsText.value = gettysburgText;
  }
  catHat.onclick = function() {
    wordsText.value = catHatText;
  };
  clear.onclick = function() {
    wordsText.value = "";
    wordCounts.innerHTML = "";
  }

  count.onclick = function() {
    var words = parseWords(wordsText.value);
    var wordCounter = words.reduce(countWords, {});
    displayWords(wordCounter);
  }
});

const gettysburgText = "Four score and seven years ago our fathers brought forth on this continent, a new nation, conceived in Liberty, and dedicated to the proposition that all men are created equal.\n\nNow we are engaged in a great civil war, testing whether that nation, or any nation so conceived and so dedicated, can long endure. We are met on a great battle-field of that war. We have come to dedicate a portion of that field, as a final resting place for those who here gave their lives that that nation might live. It is altogether fitting and proper that we should do this.\n\nBut, in a larger sense, we can not dedicate -- we can not consecrate -- we can not hallow -- this ground. The brave men, living and dead, who struggled here, have consecrated it, far above our poor power to add or detract. The world will little note, nor long remember what we say here, but it can never forget what they did here. It is for us the living, rather, to be dedicated here to the unfinished work which they who fought here have thus far so nobly advanced. It is rather for us to be here dedicated to the great task remaining before us -- that from these honored dead we take increased devotion to that cause for which they gave the last full measure of devotion -- that we here highly resolve that these dead shall not have died in vain -- that this nation, under God, shall have a new birth of freedom -- and that government of the people, by the people, for the people, shall not perish from the earth.";

const catHatText = "the sun did not shine.\nit was too wet to play.\nso we sat in the house\nall that cold, cold, wet day.\n\ni sat there with sally.\nwe sat there, we two.\nand i said, 'how i wish\nwe had something to do!'\n\ntoo wet to go out\nand too cold to play ball.\nso we sat in the house.\nwe did nothing at all.\n\nso all we could do was to\nsit!\n   sit!\n      sit!\n         sit!\nand we did not like it.\nnot one little bit.\n\nand then something went BUMP!\nhow that bump made us jump!\nwe looked!\nthen we saw him step in on the mat!\nwe looked!\nand we saw him!\nthe cat in the hat!\nand he said to us,\n'why do you sit there like that?'\n'i know it is wet\nand the sun is not sunny.\nbut we can have\nlots of good fun that is funny!'\n\n'i know some good games we could play,'\nsaid the cat.\n'i know some new tricks,'\nsaid the cat in hte hat.\n'a lot of good tricks.\ni will show them to you.\nyour mother will not mind at all if i do.'\n\nthen sally and i\ndid not know what to say.\nour mother was out of the house\nfor the day.\n\nbut our fish said, 'no! no!\nmake that cat go away!\ntell that cat in the hat\nyou do NOT want to play.\nhe should not be here.\nhe should not be about.\nhe should not be here\nwhen your mother is out!'\n\n'now! now!  have no fear.\nhave no fear!' said the cat.\n'my tricks are not bad,'\nsaid the cat in the hat.\n'why, we can have\nlots of good fun, if you wish,\nwith a game that i call\nup-up-up with a fish!'\n\n'put me down!' said the fish.\n'this is no fun at all!\nput me down!' said the fish.\n'i do NOT wish to fall!'\n\n'have no fear!' said the cat.\n'i will not let you fall.\ni will hold you up high\nas i stand on a ball.\nwith a book one one hand!\nand a cup on my hat!\nbut that is not ALL i can do!\nsaid the cat...\n\n'look at me!\nlook at me now!' said the cat.\n'with a cup and a cake\non the top of my hat!\ni can hold up TWO books!\ni can hold up the fish!\nand a little toy ship!\nand some milk on a dish!\nand look!\ni can hop up and down on the ball!\nbut that is not all!\noh, no.\nthat is not all...\n\n'look at me!\nlook at me!\nlook at me NOW!\nit is fun to have fun\nbut you have to know how.\ni can hold up the cup\nand the milk and the cake!\ni can hold up these books!\nand the fish on a rake!\ni can hold the toy ship\nand a little toy man!\nand look!  with my tail\ni can hold a red fan!\ni can fan with the fan\nas i hop on the ball!\nbut that is not all.\noh, no.\nthat is not all...'\n\nthat is what the cat said...\nthen he fell on his head!\nhe came down with a bump\nfrom up there on the ball.\nand sally and i,\nwe saw ALL the things fall!\n\nand our fish came down, too.\nhe fell into a pot!\nhe said, 'do i like this?\noh, no!  i do not.\nthis is not a good game,'\nsaid our fish as he lit.\n'no, i do not like it,\nnot one little bit!'\n\n'now look what you did!'\nsaid the fish to the cat.\n'now look at this house!\nlook at this!  look at that!\nyou sank our toy ship,\nsank it deep in the cake.\nyou shook up our house\nand you bent our new rake.\nyou SHOULD NOT be here\nwhen our mother is not.\nyou get out of this house!'\nsaid the fish in the pot.\n\n'but i like to be here.\noh, i like it a lot!'\nsaid the cat in the hat\nto the fish in the pot.\n'i will NOT go away.\ni do NOT wish to go!\nand so,' said the cat in the hat,\n'so\n  so\n   so...\ni will show you\nanother good game that i know!'\n\nand then he ran out.\nand, then, fast as a fox,\nthe cat in the hat\ncame back in with a box.\na big red wood box.\nit was shut with a hook.\n'now look at this trick,'\nsaid the cat.\n'take a look!'\n\nthen he got up on top\nwith a tip of his hat.\n'i call this game fun-in-a-box,'\nsaid the cat.\n'in this box are two things\ni will show to you now.\nyou will like these two things,'\nsaid the cat with a bow.\n\n'i will pick up the hook.\nyou will see something new.\ntwo things.  and i call them\nThing One and Thing Two.\nthese Things will not bite you.\nthey want to have fun.'\nthen, out of the box\ncame Thing Two and Thing One!\nand they ran to us fast.\nthey said, 'how do you do?\nwould you like to shake hands\nwith Thing One and Thing Two?'\n\nand sally and i\ndid not know what to do.\nso we had to shake hands\nwith Thing One and Thing Two.\nwe shook their two hands.\nbut our fish said, 'no! no!\nthose Things should not be\nin this house!  make them go!\nthey should not be here\nwhen your mother is not!\nput them out!  put them out!'\nsaid the fish in the pot.\n\n'have no fear, little fish,'\nsaid the cat in the hat.\n'these Things are good Things.'\nand he gave them a pat.\n'they are tame.  oh, so tame!\nthey have come here to play.\nthey will give you some fun\non this wet, wet, wet day.'\n\nnow, here is a game that they like,'\nsaid the cat.\n'they like to fly kites,'\nsaid the cat in the hat.\n\n'no!  not in the house!'\nsaid the fish in the pot.\n'they should not fly kites\nin a house!  they should not.\noh, the things they will bump!\noh, the things they will hit!\noh, i do not like it!\nnot one little bit!'\n\nthen sally and i\nsaw them run down the hall.\nwe saw those two Things\nbump their kites on the wall!\nbump! thump! thump! bump!\ndown the wall in the hall.\n\nthing two and thing one!\nthey ran up!  they ran down!\non the string of one kite\nwe saw mother's new gown!\nher gown with the dots\nthat are pink, white and red.\nthen we saw one kite bump\non the head of her bed!\n\nthen those things ran about\nwith big bumps, jumps and kicks\nand with hops and big thumps\nand all kinds of bad tricks.\nand i said,\n'i do NOT like the way that they play!\nif mother could see this,\noh, what would she say!'\n\nthen our fish said, 'look! look!'\nand our fish shook with fear.\n'your mother is on her way home!\ndo you hear?\noh, what will she do to us?\nwhat will she say?\noh, she will not like it\nto find us this way!'\n\n'so DO something! fast!' said the fish.\n'do you hear!\ni saw her.  your mother!\nyour mother is near!\nso, as fast as you can,\nthink of something to do!\nyou will have to get rid of\nthing one and thing two!'\n\nso, as fast as i could,\ni went after my net.\nand i said, 'with my net\ni can get them i bet.\ni bet, with my net,\ni can get those things yet!'\n\nthen i let down my net.\nit came down with a PLOP!\nand i had them!  at last!\nthose two things had to stop.\nthen i said to the cat,\n'now you do as i say.\nyou pack up those Things\nand you take them away!'\n\n'oh dear!' said the cat.\n'you did not like our game...\noh dear.\n       what a shame!\n            what a shame!\n                 what a shame!'\n\nthen he shut up the things\nin the box with the hook.\nand the cat went away\nwith a sad kind of look.\n\n'that is good,' said the fish.\n'he has gone away.  yes.\nbut your mother will come.\nshe will find this big mess!\nand this mess is so big\nand so deep and so tall,\nwe can not pick it up.\nthere is no way at all!'\n\nand THEN!\nwho was back in the house?\nwhy, the cat!\n'have no fear of this mess,'\nsaid the cat in the hat.\n'i always pick up all my playthings\nand so...\ni will show you another\ngood trick that i know!'\n\nthen we saw him pick up all the things that were down.\nhe picked up the cake,\nand the rake, and the gown,\nand the milk, and the strings,\nand the books, and the dish,\nand the fan, and the cup,\nand the ship, and the fish.\nand he put them away.\nthen he said, 'that is that.'\nand then he was gone\nwith a tip of his hat.\n\nthen our mother came in\nand she said to us two,\n'did you have any fun?\ntell me.  what did you do?'\n\nand sally and i did not know\nwhat to say.\nshould we tell her\nthe things that went on there that day?\n\nshould we tell her about it?\nnow, what SHOULD we do?\nwell...\nwhat would YOU do\nif your mother asked YOU?";

const declarationText = "In Congress, July 5, 1776.\n\nThe unanimous Declaration of the thirteen united States of America, When in the Course of human events, it becomes necessary for one people to dissolve the political bands which have connected them with another, and to assume among the powers of the earth, the separate and equal station to which the Laws of Nature and of Nature's God entitle them, a decent respect to the opinions of mankind requires that they should declare the causes which impel them to the separation.\n\nWe hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness.--That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed, --That whenever any Form of Government becomes destructive of these ends, it is the Right of the People to alter or to abolish it, and to institute new Government, laying its foundation on such principles and organizing its powers in such form, as to them shall seem most likely to effect their Safety and Happiness. Prudence, indeed, will dictate that Governments long established should not be changed for light and transient causes; and accordingly all experience hath shewn, that mankind are more disposed to suffer, while evils are sufferable, than to right themselves by abolishing the forms to which they are accustomed. But when a long train of abuses and usurpations, pursuing invariably the same Object evinces a design to reduce them under absolute Despotism, it is their right, it is their duty, to throw off such Government, and to provide new Guards for their future security.--Such has been the patient sufferance of these Colonies; and such is now the necessity which constrains them to alter their former Systems of Government. The history of the present King of Great Britain is a history of repeated injuries and usurpations, all having in direct object the establishment of an absolute Tyranny over these States. To prove this, let Facts be submitted to a candid world.\n\nHe has refused his Assent to Laws, the most wholesome and necessary for the public good.\n\nHe has forbidden his Governors to pass Laws of immediate and pressing importance, unless suspended in their operation till his Assent should be obtained; and when so suspended, he has utterly neglected to attend to them.\n\nHe has refused to pass other Laws for the accommodation of large districts of people, unless those people would relinquish the right of Representation in the Legislature, a right inestimable to them and formidable to tyrants only.\n\nHe has called together legislative bodies at places unusual, uncomfortable, and distant from the depository of their public Records, for the sole purpose of fatiguing them into compliance with his measures.\n\nHe has dissolved Representative Houses repeatedly, for opposing with manly firmness his invasions on the rights of the people.\n\nHe has refused for a long time, after such dissolutions, to cause others to be elected; whereby the Legislative powers, incapable of Annihilation, have returned to the People at large for their exercise; the State remaining in the mean time exposed to all the dangers of invasion from without, and convulsions within.\n\nHe has endeavoured to prevent the population of these States; for that purpose obstructing the Laws for Naturalization of Foreigners; refusing to pass others to encourage their migrations hither, and raising the conditions of new Appropriations of Lands.\n\nHe has obstructed the Administration of Justice, by refusing his Assent to Laws for establishing Judiciary powers.\n\nHe has made Judges dependent on his Will alone, for the tenure of their offices, and the amount and payment of their salaries.\n\nHe has erected a multitude of New Offices, and sent hither swarms of Officers to harrass our people, and eat out their substance.\n\nHe has kept among us, in times of peace, Standing Armies without the Consent of our legislatures.\n\nHe has affected to render the Military independent of and superior to the Civil power.\n\nHe has combined with others to subject us to a jurisdiction foreign to our constitution, and unacknowledged by our laws; giving his Assent to their Acts of pretended Legislation:\n\nFor Quartering large bodies of armed troops among us:\n\nFor protecting them, by a mock Trial, from punishment for any Murders which they should commit on the Inhabitants of these States:\n\nFor cutting off our Trade with all parts of the world:\n\nFor imposing Taxes on us without our Consent:\n\nFor depriving us in many cases, of the benefits of Trial by Jury:\n\nFor transporting us beyond Seas to be tried for pretended offences\n\nFor abolishing the free System of English Laws in a neighbouring Province, establishing therein an Arbitrary government, and enlarging its Boundaries so as to render it at once an example and fit instrument for introducing the same absolute rule into these Colonies:\n\nFor taking away our Charters, abolishing our most valuable Laws, and altering fundamentally the Forms of our Governments:\n\nFor suspending our own Legislatures, and declaring themselves invested with power to legislate for us in all cases whatsoever.\n\nHe has abdicated Government here, by declaring us out of his Protection and waging War against us.\n\nHe has plundered our seas, ravaged our Coasts, burnt our towns, and destroyed the lives of our people.\n\nHe is at this time transporting large Armies of foreign Mercenaries to compleat the works of death, desolation and tyranny, already begun with circumstances of Cruelty & perfidy scarcely paralleled in the most barbarous ages, and totally unworthy the Head of a civilized nation.\n\nHe has constrained our fellow Citizens taken Captive on the high Seas to bear Arms against their Country, to become the executioners of their friends and Brethren, or to fall themselves by their Hands.\n\nHe has excited domestic insurrections amongst us, and has endeavoured to bring on the inhabitants of our frontiers, the merciless Indian Savages, whose known rule of warfare, is an undistinguished destruction of all ages, sexes and conditions.\n\nIn every stage of these Oppressions We have Petitioned for Redress in the most humble terms: Our repeated Petitions have been answered only by repeated injury. A Prince whose character is thus marked by every act which may define a Tyrant, is unfit to be the ruler of a free people.\n\nNor have We been wanting in attentions to our Brittish brethren. We have warned them from time to time of attempts by their legislature to extend an unwarrantable jurisdiction over us. We have reminded them of the circumstances of our emigration and settlement here. We have appealed to their native justice and magnanimity, and we have conjured them by the ties of our common kindred to disavow these usurpations, which, would inevitably interrupt our connections and correspondence. They too have been deaf to the voice of justice and of consanguinity. We must, therefore, acquiesce in the necessity, which denounces our Separation, and hold them, as we hold the rest of mankind, Enemies in War, in Peace Friends.\n\nWe, therefore, the Representatives of the United States of America, in General Congress, Assembled, appealing to the Supreme Judge of the world for the rectitude of our intentions, do, in the Name, and by Authority of the good People of these Colonies, solemnly publish and declare, That these United Colonies are, and of Right ought to be Free and Independent States; that they are Absolved from all Allegiance to the British Crown, and that all political connection between them and the State of Great Britain, is and ought to be totally dissolved; and that as Free and Independent States, they have full Power to levy War, conclude Peace, contract Alliances, establish Commerce, and to do all other Acts and Things which Independent States may of right do. And for the support of this Declaration, with a firm reliance on the protection of divine Providence, we mutually pledge to each other our Lives, our Fortunes and our sacred Honor";
